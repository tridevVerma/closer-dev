class PostComments{constructor(e){this.postId=e,this.postContainer=$(`#post-${e}`),this.newCommentForm=$(`#post-${e}-comment-form`),this.createComment(e);let t=this;$(this.postContainer).find(".delete-comment-btn").each((function(e,n){t.deleteComment(n)})),$(this.postContainer).find(".like-comment-btn").each((function(e,n){t.likeComment(n)}))}createComment=function(e){let t=this;$(this.newCommentForm).submit((n=>{n.preventDefault(),$.ajax({type:"POST",url:"/users/comments/create",data:$(this.newCommentForm).serialize(),success:function(n){let o=t.newCommentDom(n.data.comment,n.data.username),m=$(`#comment-post-id-${e}`);$(m).prepend(o),$(t.newCommentForm)[0].reset(),t.deleteComment($(o).find(".delete-comment-btn")),t.likeComment($(o).find(".like-comment-btn")),t.notifyMsg("Comment created!!","success")},error:function(e){t.notifyMsg(e.responseText,"error")}})}))};newCommentDom=function(e,t){return $(`<li id="comment-${e._id}">\n        <p><strong>${t} : </strong>&nbsp;${e.content}</p>\n        <a class="like-comment-btn" href="/users/like/?type=Comment&id=${e._id}">\n            <i class="fa-regular fa-thumbs-up"></i>\n            <span class="comment-likes-count">0</span>\n        </a>\n        <a href="/users/comments/destroy/${e._id}" class="delete-comment-btn">x</a>\n    </li>`)};deleteComment=function(e){let t=this;$(e).click((function(n){n.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$(`#comment-${e.data.comment_id}`).remove(),t.notifyMsg("Comment removed!!","success")},error:function(e){t.notifyMsg(e.responseText,"error")}})}))};likeComment(e){let t=this;$(e).click((function(n){n.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(n){$(e).children(".comment-likes-count").text(n.count),t.notifyMsg(n.likeAdded?"comment liked":"comment disliked","success")},error:function(e){t.notifyMsg(e.responseText,"error")}})}))}notifyMsg=function(e,t){new Noty({theme:"relax",text:e,type:t,layout:"topRight",timeout:1500}).show()}}