<style>
    body{
        background-color: blueviolet;
    }
    input{
        width: 100%;
        padding: 6px;
        font-size: 1rem;
        margin-bottom: 1.2rem;
    }

    input[type="submit"]{
        background-color: #222;
        color:white;
        border:none;
        padding:10px;
    }

    input[type="submit"]:hover{
        cursor: pointer;
        background-color: #000;
    }

    .post-user-name{
        color:blueviolet;
        font-size: 1rem;
    }
</style>

<h1>Home Page</h1>

<section id="feed-posts">
    <% if (locals.user) { %>
        <h2><%= user.name%>'s posts</h2>
    <% } %>

    <% if (locals.user) { %>
    <form id="new-post-form" method="POST" action="/users/posts/create">
        <input type="text" name="post-title" id="post-title">
        <textarea name="post-content" id="post-content" cols="80" rows="20" placeholder="Type Here ...."></textarea>
        <input type="submit" value="Post">
    </form>
    <% } %>
    <div class="show-posts">
        <h2>Show Posts Here</h2>
        <ul>
            <% for (let post of posts ) { %>
                <li id="post-<%= post._id%>">
                    <div class="title-close">
                        <h3><%=post.title%> - <span class="post-user-name"><%= post.user.name%></span></h3>
                        <% if(locals.user && locals.user.id == post.user.id){ %>
                            <a href="/users/posts/destroy/<%= post._id%>" class="delete-post-btn"><h3>X</h3></a>
                        <% } %>
                    </div>
                    <p><%=post.content%></p>
                    <div class="comments-section">
                        <% if (locals.user) { %>
                            <form method="POST" action="/users/comments/create" class="new-comment-form">
                                <input type="text" name="comment-content" placeholder="Comments here ....">
                                <input type="hidden" name="post" value="<%=post._id%>">
                                <input type="submit" value="Submit">
                            </form>
                        <% } %>
                        <div class="show-comments">
                            <ul id="comment-post-id-<%= post._id%>">
                                <% for ( let comment of post.comments ) { %>
                                    <li id="comment-<%=comment._id%>">
                                        <strong><%= comment.user.name%> : </strong>
                                        &nbsp;
                                        <%= comment.content %>
                                        <% if(locals.user && locals.user.id == comment.user.id){ %> 
                                            <a href="/users/comments/destroy/<%= comment._id%>" class="delete-comment-btn">x</a>
                                        <% } %>
                                    </li>
                                <% } %>
                            </ul>
                        </div>
                    </div>
                    
                </li>
            <% } %>
        </ul>

    </div>
</section>

<% if(locals.user) { %>
    <section id="users-freinds">
        <h4>Freinds</h4>
        <% for (u of all_users) { %>
            <a href="/users/view_profile/<%= u.id%>">
                <p><%= u.name%></p>
            </a>
        <% } %>
    </section>
<% } %>

<script src="/scripts/home_posts.js"></script>
<script src="/scripts/posts_comments.js"></script>